---
created: 2025-02-06T08:41
updated: 2025-02-17T08:22
---
â—€ [[2025-02-05]] - [[2025-02-07]] â–¶
## Summary ğŸŒ²
Verantwortlicher: Mete ğŸ‰
## Vormittag
#### Ablauf ğŸ§­
###### 1. Wiederholung Incident Response & SIEM
* Schneller durchlauf was wir gestern bezÃ¼glich Incident Response aufgeschrieben haben [[Incident-Response.ex]].
* besprochen wie wir uns damals mit dem Wazu Lab verbunden haben und was wir bisher gemacht haben [[Wazuh.ex]] .
###### 2. Neue Benutzer anlegen (Linux & Windows)
Neuen Benutzer in Kali anlegen
```bash
sudo adduser meinNeuerBenutzer
```
um zu schauen ob es funktioniert hat kann man ganz einfach
```bash
ls /home
```
machen und schauen ob dort ein neuer Ordner angelegt wurde, mit ein wenig Geduld sieht man das aber auch im Wazuh Lab.

Neuen Benutzer in Windows anlegen
```Powershell
New-localUser -Name "MeinNeuerBenutzer"
```
bei dem Windows Agent kann man auch im Wazuh Lab nachschauen ob es funktioniert hat in beiden FÃ¤llen findet man es unter dem Threat Hunting Tab.

###### 3. NetzwerkÃ¼berwachung konfigurieren
* Suricata alles bezÃ¼glich Suricata wird auch auf [Network IDS integration - Proof of Concept guide Â· Wazuh documentation](https://documentation.wazuh.com/current/proof-of-concept-guide/integrate-network-ids-suricata.html) oder bei [[Suricata-Config]] und auch bei [[Wazuh.ex]] erklÃ¤rt.

* Detektionsregeln [GitHub - aleksibovellan/opnsense-suricata-nmaps: OPNSense's Suricata IDS/IPS Detection Rules Against NMAP Scans](https://github.com/aleksibovellan/opnsense-suricata-nmaps)
###### â›© Bingoliste/ErgÃ¤nzungen ğŸ¾
* Business Continuity Management*
* Ein Hotel das Ziel eines Cyberangriffs wurde und dadruch Insolvenz anmelden musste.[Finanzielle Schieflage: Cyberangriff treibt Hotelbetreiber in die Insolvenz - Golem.de](https://www.golem.de/news/finanzielle-schieflage-cyberangriff-treibt-hotelbetreiber-in-die-insolvenz-2502-192980.html)
* Threat Hunting
* Mitre [MITRE ATT&CKÂ®](https://attack.mitre.org/)
###### Zusammenfassung ğŸŒ²

## Nachmittag
Die Aufgabe am Nachmittag besteht darin Nmap-Scans mit Suricata in unserem Wazuh-Lab zu erkennen und die Erkennung in den Logs zu Ã¼berprÃ¼fen.
###### AufgabenğŸ“š
Als erstes mÃ¼ssen wir die Suricata Datei anpassen das machen wir indem wir den Befehl in Linux eingeben
```bash
vim /etc/suricata/suricata.yaml
```
und da Ã¤ndern wir 
```yaml
HOME_NET: "<IP_KALI_AGENT>"
EXTERNAL_NET: "any"

default-rule-path: /etc/suricata/rules
rule-files:
- "*.rules"

# Linux high speed capture support
af-packet:
  - interface: eth0
```
Als zweites mÃ¼ssen wir den Eintrag in der ossec.conf auf dem Agenten Ã¤ndern und den Suricara Agenten hinzufÃ¼gen die findet ihr unter /var/ossec/etc/ossec.conf
```xml
<ossec_config>
  <localfile>
    <log_format>json</log_format>
    <location>/var/log/suricata/eve.json</location>
  </localfile>
</ossec_config>
```
dann starten wir einmal den Wazuh Service neu mit
```bash
sudo systemctl restart wazuh-agent
```
So und als letztes mÃ¼ssen wir noch die Detektionsdatei von github hinzufÃ¼gen dafÃ¼r gehen wir erstmal in den Ordner /etc/suricata/rules und ziehen die Detektions datei dann aus github das machen wir mit 
```bash
git clone https://github.com/aleksibovellan/opnsense-suricata-nmaps.git
```
dann sind wir schon so gut wie durch wir mÃ¼ssen nurnoch einmal den Suricata server neustarten das machen wir ganz einfach mit dem Befehl
```bash
sudo systemctl restart suricata
```
und nun machen wir einen nmap scan auf eurer kali Maschine und schauen im Wazuh lab ob es uns eingezeigt wird der Nmap Befehl ist
```
nmap 192.168.X.X
```
###### Zusammenfassung ğŸŒ²

---
```dataview
TABLE file.ctime AS "Created", file.mtime AS "Updated", file.size AS "Size" 
WHERE file.cday = date(this.file.name) OR file.mday = date(this.file.name) 
```
