# RasPiPenTest: Integriertes Pentesting-Tool für Raspberry Pi

Hier ist ein Programm, das Aircrack-ng, Wireshark und Bettercap in einer einheitlichen Oberfläche für Raspberry Pi vereint und mit Autostart-Funktion ausgestattet ist.

## Installation der Grundkomponenten

Zuerst müssen wir die notwendigen Pakete installieren:

bash

`#!/bin/bash # Update und Upgrade sudo apt update -y sudo apt upgrade -y # Installation der Haupttools sudo apt install -y tcpdump aircrack-ng wireshark tmux python3-pip git libpcap-dev libusb-1.0-0-dev libnetfilter-queue-dev # Installation von Bettercap mkdir -p ~/source cd ~/source git clone --recurse-submodules https://github.com/bettercap/bettercap.git cd bettercap make sudo cp $(go env GOPATH)/bin/bettercap /usr/bin/ # Installation zusätzlicher Python-Abhängigkeiten pip3 install flask flask-socketio psutil`

## Hauptprogramm

Erstellen wir nun das Hauptprogramm `raspipentest.py`:

python

`#!/usr/bin/env python3 import os import subprocess import signal import sys import json import psutil from flask import Flask, render_template, request, jsonify from flask_socketio import SocketIO import threading import time app = Flask(__name__) socketio = SocketIO(app) # Globale Variablen processes = {} interfaces = [] current_network = None # Verzeichnisse erstellen os.makedirs('/home/pi/pentest_results', exist_ok=True) os.makedirs('/home/pi/pentest_scripts', exist_ok=True) def get_wireless_interfaces():     """Verfügbare WLAN-Interfaces ermitteln"""    result = subprocess.run(['iwconfig'], capture_output=True, text=True)    interfaces = []    for line in result.stdout.split('\n'):        if ' ESSID:' in line:            iface = line.split(' ')[0]            interfaces.append(iface)    return interfaces def set_monitor_mode(interface):     """Interface in den Monitor-Modus versetzen"""    subprocess.run(['sudo', 'ifconfig', interface, 'down'])    subprocess.run(['sudo', 'iwconfig', interface, 'mode', 'monitor'])    subprocess.run(['sudo', 'ifconfig', interface, 'up'])    return True def start_bettercap(interface):     """Bettercap mit dem angegebenen Interface starten"""    # Bettercap-Konfigurationsdatei erstellen    config = f""" set wifi.interface {interface} set events.stream.output /home/pi/pentest_results/bettercap-events.log set wifi.handshakes.file /home/pi/pentest_results/handshakes.pcap set ticker.commands wifi.deauth all; wifi.assoc all; set ticker.period 5 events.stream on ticker on wifi.recon on     """    with open('/home/pi/pentest_scripts/bettercap.cap', 'w') as f:        f.write(config)         # Bettercap starten    cmd = ['sudo', 'bettercap', '-iface', interface, '-caplet', '/home/pi/pentest_scripts/bettercap.cap']    proc = subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)    processes['bettercap'] = proc    return True def start_airodump(interface, channel=None, bssid=None):     """Airodump-ng starten"""    cmd = ['sudo', 'airodump-ng']    if channel:        cmd.extend(['-c', str(channel)])    if bssid:        cmd.extend(['--bssid', bssid])    cmd.extend(['-w', '/home/pi/pentest_results/capture', interface])         proc = subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE)    processes['airodump'] = proc    return True def start_wireshark(interface):     """Wireshark starten"""    cmd = ['sudo', 'wireshark', '-i', interface, '-k']    proc = subprocess.Popen(cmd)    processes['wireshark'] = proc    return True def deauth_client(interface, ap_mac, client_mac):     """Deauthentifizierungsangriff starten"""    cmd = ['sudo', 'aireplay-ng', '-0', '1', '-a', ap_mac, '-c', client_mac, interface]    subprocess.run(cmd)    return True def crack_handshake(capture_file, wordlist):     """WPA-Handshake mit Aircrack-ng knacken"""    cmd = ['sudo', 'aircrack-ng', capture_file, '-w', wordlist]    proc = subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)    processes['aircrack'] = proc    return True @app.route('/') def index():     """Hauptseite rendern"""    global interfaces    interfaces = get_wireless_interfaces()    return render_template('index.html', interfaces=interfaces) @app.route('/api/start_monitor', methods=['POST']) def api_start_monitor():     """API-Endpunkt zum Starten des Monitor-Modus"""    data = request.json    interface = data.get('interface')    if set_monitor_mode(interface):        return jsonify({'success': True})    return jsonify({'success': False, 'error': 'Failed to set monitor mode'}) @app.route('/api/start_tool', methods=['POST']) def api_start_tool():     """API-Endpunkt zum Starten eines Tools"""    data = request.json    tool = data.get('tool')    interface = data.get('interface')         if tool == 'bettercap':        success = start_bettercap(interface)    elif tool == 'airodump':        channel = data.get('channel')        bssid = data.get('bssid')        success = start_airodump(interface, channel, bssid)    elif tool == 'wireshark':        success = start_wireshark(interface)    else:        return jsonify({'success': False, 'error': 'Unknown tool'})         return jsonify({'success': success}) @app.route('/api/stop_tool', methods=['POST']) def api_stop_tool():     """API-Endpunkt zum Stoppen eines Tools"""    data = request.json    tool = data.get('tool')         if tool in processes:        processes[tool].terminate()        del processes[tool]        return jsonify({'success': True})    return jsonify({'success': False, 'error': 'Tool not running'}) @app.route('/api/deauth', methods=['POST']) def api_deauth():     """API-Endpunkt für Deauthentifizierungsangriff"""    data = request.json    interface = data.get('interface')    ap_mac = data.get('ap_mac')    client_mac = data.get('client_mac')         success = deauth_client(interface, ap_mac, client_mac)    return jsonify({'success': success}) @app.route('/api/crack', methods=['POST']) def api_crack():     """API-Endpunkt zum Starten des Passwort-Crackings"""    data = request.json    capture_file = data.get('capture_file')    wordlist = data.get('wordlist')         success = crack_handshake(capture_file, wordlist)    return jsonify({'success': success}) def cleanup():     """Alle laufenden Prozesse beenden"""    for name, proc in processes.items():        try:            proc.terminate()        except:            pass if __name__ == '__main__':     # Signal-Handler für sauberes Beenden    def signal_handler(sig, frame):        cleanup()        sys.exit(0)         signal.signal(signal.SIGINT, signal_handler)    signal.signal(signal.SIGTERM, signal_handler)         # Server starten    socketio.run(app, host='0.0.0.0', port=8080, debug=True)`

## HTML-Template

Erstellen wir ein einfaches Frontend für unser Tool:

bash

`mkdir -p ~/raspipentest/templates nano ~/raspipentest/templates/index.html`

Inhalt der `index.html`:

xml

`<!DOCTYPE html> <html lang="de"> <head>     <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>RasPiPenTest</title>    <style>        body {            font-family: Arial, sans-serif;            margin: 0;            padding: 20px;            background-color: #f0f0f0;        }        .container {            max-width: 1200px;            margin: 0 auto;            background-color: white;            padding: 20px;            border-radius: 5px;            box-shadow: 0 2px 5px rgba(0,0,0,0.1);        }        .panel {            margin-bottom: 20px;            padding: 15px;            border: 1px solid #ddd;            border-radius: 4px;        }        h1, h2 {            color: #333;        }        button {            background-color: #4CAF50;            color: white;            padding: 10px 15px;            border: none;            border-radius: 4px;            cursor: pointer;            margin-right: 10px;            margin-bottom: 10px;        }        button:hover {            background-color: #45a049;        }        select, input {            padding: 8px;            margin-bottom: 10px;            width: 100%;            box-sizing: border-box;        }        .tool-panel {            display: none;        }        .active {            display: block;        }        .log {            background-color: #f8f8f8;            border: 1px solid #ddd;            padding: 10px;            height: 200px;            overflow-y: auto;            font-family: monospace;        }    </style> </head> <body>     <div class="container">        <h1>RasPiPenTest - Integriertes Pentesting-Tool</h1>                 <div class="panel">            <h2>WLAN-Interface</h2>            <select id="interface">                {% for iface in interfaces %}                <option value="{{ iface }}">{{ iface }}</option>                {% endfor %}            </select>            <button onclick="setMonitorMode()">Monitor-Modus aktivieren</button>        </div>                 <div class="panel">            <h2>Tools</h2>            <button onclick="showTool('bettercap')">Bettercap</button>            <button onclick="showTool('aircrack')">Aircrack-ng</button>            <button onclick="showTool('wireshark')">Wireshark</button>        </div>                 <div id="bettercap-panel" class="panel tool-panel">            <h2>Bettercap</h2>            <button onclick="startTool('bettercap')">Bettercap starten</button>            <button onclick="stopTool('bettercap')">Bettercap stoppen</button>            <div class="log" id="bettercap-log"></div>        </div>                 <div id="aircrack-panel" class="panel tool-panel">            <h2>Aircrack-ng</h2>            <div>                <label for="channel">Kanal (optional):</label>                <input type="number" id="channel" min="1" max="14">            </div>            <div>                <label for="bssid">BSSID (optional):</label>                <input type="text" id="bssid" placeholder="00:11:22:33:44:55">            </div>            <button onclick="startAirodump()">Airodump-ng starten</button>            <button onclick="stopTool('airodump')">Airodump-ng stoppen</button>                         <h3>Deauthentifizierung</h3>            <div>                <label for="ap-mac">AP MAC-Adresse:</label>                <input type="text" id="ap-mac" placeholder="00:11:22:33:44:55">            </div>            <div>                <label for="client-mac">Client MAC-Adresse:</label>                <input type="text" id="client-mac" placeholder="00:11:22:33:44:55">            </div>            <button onclick="deauthClient()">Deauthentifizieren</button>                         <h3>Handshake knacken</h3>            <div>                <label for="capture-file">Capture-Datei:</label>                <input type="text" id="capture-file" value="/home/pi/pentest_results/capture-01.cap">            </div>            <div>                <label for="wordlist">Wörterbuch:</label>                <input type="text" id="wordlist" value="/usr/share/wordlists/rockyou.txt">            </div>            <button onclick="crackHandshake()">Handshake knacken</button>        </div>                 <div id="wireshark-panel" class="panel tool-panel">            <h2>Wireshark</h2>            <button onclick="startTool('wireshark')">Wireshark starten</button>        </div>    </div>     <script>        function setMonitorMode() {            const interface = document.getElementById('interface').value;            fetch('/api/start_monitor', {                method: 'POST',                headers: {                    'Content-Type': 'application/json'                },                body: JSON.stringify({ interface })            })            .then(response => response.json())            .then(data => {                if (data.success) {                    alert('Monitor-Modus aktiviert!');                } else {                    alert('Fehler: ' + data.error);                }            });        }                 function showTool(tool) {            // Alle Tool-Panels ausblenden            document.querySelectorAll('.tool-panel').forEach(panel => {                panel.classList.remove('active');            });                         // Gewähltes Tool-Panel anzeigen            document.getElementById(tool + '-panel').classList.add('active');        }                 function startTool(tool) {            const interface = document.getElementById('interface').value;            fetch('/api/start_tool', {                method: 'POST',                headers: {                    'Content-Type': 'application/json'                },                body: JSON.stringify({ tool, interface })            })            .then(response => response.json())            .then(data => {                if (data.success) {                    alert(tool + ' gestartet!');                } else {                    alert('Fehler: ' + data.error);                }            });        }                 function startAirodump() {            const interface = document.getElementById('interface').value;            const channel = document.getElementById('channel').value;            const bssid = document.getElementById('bssid').value;                         fetch('/api/start_tool', {                method: 'POST',                headers: {                    'Content-Type': 'application/json'                },                body: JSON.stringify({                    tool: 'airodump',                    interface,                    channel: channel || null,                    bssid: bssid || null                })            })            .then(response => response.json())            .then(data => {                if (data.success) {                    alert('Airodump-ng gestartet!');                } else {                    alert('Fehler: ' + data.error);                }            });        }                 function stopTool(tool) {            fetch('/api/stop_tool', {                method: 'POST',                headers: {                    'Content-Type': 'application/json'                },                body: JSON.stringify({ tool })            })            .then(response => response.json())            .then(data => {                if (data.success) {                    alert(tool + ' gestoppt!');                } else {                    alert('Fehler: ' + data.error);                }            });        }                 function deauthClient() {            const interface = document.getElementById('interface').value;            const apMac = document.getElementById('ap-mac').value;            const clientMac = document.getElementById('client-mac').value;                         if (!apMac || !clientMac) {                alert('Bitte AP und Client MAC-Adressen angeben!');                return;            }                         fetch('/api/deauth', {                method: 'POST',                headers: {                    'Content-Type': 'application/json'                },                body: JSON.stringify({                    interface,                    ap_mac: apMac,                    client_mac: clientMac                })            })            .then(response => response.json())            .then(data => {                if (data.success) {                    alert('Deauthentifizierung gesendet!');                } else {                    alert('Fehler: ' + data.error);                }            });        }                 function crackHandshake() {            const captureFile = document.getElementById('capture-file').value;            const wordlist = document.getElementById('wordlist').value;                         fetch('/api/crack', {                method: 'POST',                headers: {                    'Content-Type': 'application/json'                },                body: JSON.stringify({                    capture_file: captureFile,                    wordlist: wordlist                })            })            .then(response => response.json())            .then(data => {                if (data.success) {                    alert('Handshake-Cracking gestartet!');                } else {                    alert('Fehler: ' + data.error);                }            });        }    </script> </body> </html>`

## Autostart-Konfiguration

Für die Autostart-Funktion erstellen wir einen systemd-Service:

bash

`sudo nano /etc/systemd/`